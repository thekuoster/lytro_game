/*
 * jQuery UI Autocomplete 1.9m3
 *
 * Copyright 2010, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Autocomplete
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	jquery.ui.position.js
 *	jquery.ui.menu.js
 */
(function(e){e.widget("ui.autocomplete",{options:{appendTo:"body",delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null},_create:function(){var a=this,d=this.element[0].ownerDocument,f;this.element.addClass("ui-autocomplete-input").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(b){if(!(a.options.disabled||a.element.attr("readonly"))){f=false;var c=e.ui.keyCode;switch(b.keyCode){case c.PAGE_UP:a._move("previousPage",
b);break;case c.PAGE_DOWN:a._move("nextPage",b);break;case c.UP:a._move("previous",b);b.preventDefault();break;case c.DOWN:a._move("next",b);b.preventDefault();break;case c.ENTER:case c.NUMPAD_ENTER:if(a.menu.active){f=true;b.preventDefault()}case c.TAB:if(!a.menu.active)return;a.menu.select(b);break;case c.ESCAPE:a.element.val(a.term);a.close(b);break;default:clearTimeout(a.searching);a.searching=setTimeout(function(){if(a.term!=a.element.val()){a.selectedItem=null;a.search(null,b)}},a.options.delay);
break}}}).bind("keypress.autocomplete",function(b){if(f){f=false;b.preventDefault()}}).bind("focus.autocomplete",function(){if(!a.options.disabled){a.selectedItem=null;a.previous=a.element.val()}}).bind("blur.autocomplete",function(b){if(!a.options.disabled){clearTimeout(a.searching);a.closing=setTimeout(function(){a.close(b);a._change(b)},150)}});this._initSource();this.response=function(){return a._response.apply(a,arguments)};this.menu=e("<ul></ul>").addClass("ui-autocomplete").appendTo(e(this.options.appendTo||
"body",d)[0]).mousedown(function(b){var c=a.menu.element[0];e(b.target).closest(".ui-menu-item").length||setTimeout(function(){e(document).one("mousedown",function(g){g.target!==a.element[0]&&g.target!==c&&!e.ui.contains(c,g.target)&&a.close()})},1);setTimeout(function(){clearTimeout(a.closing)},13)}).menu({input:e(),focus:function(b,c){c=c.item.data("item.autocomplete");false!==a._trigger("focus",b,{item:c})&&/^key/.test(b.originalEvent.type)&&a.element.val(c.value)},select:function(b,c){c=c.item.data("item.autocomplete");
var g=a.previous;if(a.element[0]!==d.activeElement){a.element.focus();a.previous=g;setTimeout(function(){a.previous=g},1)}false!==a._trigger("select",b,{item:c})&&a.element.val(c.value);a.term=a.element.val();a.close(b);a.selectedItem=c},blur:function(){a.menu.element.is(":visible")&&a.element.val()!==a.term&&a.element.val(a.term)}}).zIndex(this.element.zIndex()+1).css({top:0,left:0}).hide().data("menu");e.fn.bgiframe&&this.menu.element.bgiframe()},destroy:function(){this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup");
this.menu.element.remove();this._super("destroy")},_setOption:function(a){this._superApply("_setOption",arguments);a==="source"&&this._initSource();if(a==="appendTo")this.menu.element.appendTo(e(value||"body",this.element[0].ownerDocument)[0])},_initSource:function(){var a=this,d,f;if(e.isArray(this.options.source)){d=this.options.source;this.source=function(b,c){c(e.ui.autocomplete.filter(d,b.term))}}else if(typeof this.options.source==="string"){f=this.options.source;this.source=function(b,c){a.xhr&&
a.xhr.abort();a.xhr=e.getJSON(f,b,function(g,i,h){h===a.xhr&&c(g);a.xhr=null})}}else this.source=this.options.source},search:function(a,d){a=a!=null?a:this.element.val();this.term=this.element.val();if(a.length<this.options.minLength)return this.close(d);clearTimeout(this.closing);if(this._trigger("search",d)!==false)return this._search(a)},_search:function(a){this.element.addClass("ui-autocomplete-loading");this.source({term:a},this.response)},_response:function(a){if(a&&a.length){a=this._normalize(a);
this._suggest(a);this._trigger("open")}else this.close();this.element.removeClass("ui-autocomplete-loading")},close:function(a){clearTimeout(this.closing);if(this.menu.element.is(":visible")){this._trigger("close",a);this.menu.element.hide();this.menu.deactivate()}},_change:function(a){this.previous!==this.element.val()&&this._trigger("change",a,{item:this.selectedItem})},_normalize:function(a){if(a.length&&a[0].label&&a[0].value)return a;return e.map(a,function(d){if(typeof d==="string")return{label:d,
value:d};return e.extend({label:d.label||d.value,value:d.value||d.label},d)})},_suggest:function(a){this._renderMenu(this.menu.element.empty().zIndex(this.element.zIndex()+1),a);this.menu.deactivate();this.menu.refresh();this.menu.element.show().position(e.extend({of:this.element},this.options.position));this._resizeMenu()},_resizeMenu:function(){var a=this.menu.element;a.outerWidth(Math.max(a.width("").outerWidth(),this.element.outerWidth()))},_renderMenu:function(a,d){var f=this;e.each(d,function(b,
c){f._renderItem(a,c)})},_renderItem:function(a,d){return e("<li></li>").data("item.autocomplete",d).append(e("<a></a>").text(d.label)).appendTo(a)},_move:function(a,d){if(this.menu.element.is(":visible"))if(this.menu.first()&&/^previous/.test(a)||this.menu.last()&&/^next/.test(a)){this.element.val(this.term);this.menu.deactivate()}else this.menu[a](d);else this.search(null,d)},widget:function(){return this.menu.element}});e.extend(e.ui.autocomplete,{escapeRegex:function(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,
"\\$&")},filter:function(a,d){var f=new RegExp(e.ui.autocomplete.escapeRegex(d),"i");return e.grep(a,function(b){return f.test(b.label||b.value||b)})}})})(jQuery);
